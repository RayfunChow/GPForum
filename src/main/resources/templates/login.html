<!DOCTYPE html>
<html lang="zh-hans">
<head>
	<meta charset="UTF-8">
	<title>欢迎使用</title>
	<!--CSS-->
	<link rel="stylesheet" href="/css/bootstrap.min.css">
	<link rel="stylesheet" href="/css/auth.css">
	<!--JS-->
	<script src="/js/jquery-3.3.1.slim.min.js"></script>
	<script src="/js/popper.min.js"></script>
	<script src="/js/bootstrap.min.js"></script>
	<script src="http://static.runoob.com/assets/jquery-validation-1.14.0/lib/jquery.js"></script>
	<script src="http://static.runoob.com/assets/jquery-validation-1.14.0/dist/jquery.validate.min.js"></script>
	<script src="http://static.runoob.com/assets/jquery-validation-1.14.0/dist/localization/messages_zh.js"></script>
	<!--<script src="/js/auth.js"></script>-->
	<script src="/js/jquery.validate.min.js"></script>

</head>

<body style="background: url(../img/loginbg.jpg) center top; height: 700px;">
<nav class="navbar navbar-expand-lg navbar-light bg-light fixed-top">
	<div class="container">
		<aa class="navbar-brand" href="">聚集地论坛</aa>
		<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent"
				aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
			<span class="navbar-toggler-icon"></span>
		</button>

		<div class="collapse navbar-collapse" id="navbarSupportedContent">
			<ul class="navbar-nav mr-auto">
				<li class="nav-item active">
					<a class="nav-link" href="index">首页<span class="sr-only">(current)</span></a>
				</li>
				<li class="nav-item">
					<a class="nav-link" href="section">板块</a>
				</li>
				<li class="nav-item">
					<a class="nav-link" href="profile">个人信息</a>
				</li>
			</ul>
			<ul class="nav navbar-nav navbar-right">
				<form class="form-inline my-2 my-lg-0"  style="margin: 10px">
					<input class="form-control mr-sm-2" type="search" placeholder="Search" aria-label="Search">
					<button class="btn btn-outline-success my-2 my-sm-0" type="submit">Search</button>
				</form>
				<li class="nav-item">
					<a class="nav-link" href="message">消息中心</a>
				</li>
				<li class="nav-item dropdown">
					<a class="nav-link dropdown-toggle" href="#" id="userName" role="button" data-toggle="dropdown"
					   aria-haspopup="true" aria-expanded="false">
						<img class="nav-item rounded-circle" src="../img/no_avatar.png" width="30px" height="30px" alt="">
					</a>
					<div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
						<a class="dropdown-item" href="/UpdatePwd" data-toggle="modal"
						   data-target="#changePasswordModal">更改密码</a>
					</div>
				</li>
				<li class="nav-item">
					<a class="nav-link" href="index" id="login"></a>
				</li>
			</ul>
		</div>

		<!--<a class="btn btn-sm btn-outline-secondary" style="margin-left:5px;" href="../html/signup.html">注册</a>-->

	</div>
</nav>

	<div class="row" >
		<div class="col-7">

		</div>
		<div class="lowin col-5">
			<div class="lowin-brand">
				<!--<img src="kodinger.jpg" alt="logo">-->
			</div>
			<div class="lowin-wrapper">
				<div class="lowin-box lowin-login">
					<div class="lowin-box-inner">
						<form id="signinForm">
							<p>登录到聚集地论坛</p>
							<div class="lowin-group">
								<label>Email <a href="#" class="login-back-link">Sign in?</a></label>
								<input type="email" autocomplete="email" name="email" class="lowin-input" id="Email">
							</div>
							<div class="lowin-group password-group">
								<label>密&nbsp;&nbsp;码 <a href="#" class="forgot-link" style="visibility: hidden">Forgot Password?</a></label>
								<input type="password" maxlength="16" name="password" autocomplete="current-password" class="lowin-input" id="Password">
							</div>
							<button class="lowin-btn login-btn" style="margin-top: 15px" onclick="signin()" type="button">
								登录
							</button>

							<div class="text-foot">
								还没有账户？ <a href="" class="register-link">现在注册</a>
							</div>
						</form>
					</div>
				</div>

				<div class="lowin-box lowin-register">
					<div class="lowin-box-inner">
						<form id="signupForm">
							<p>1分钟极速注册</p>
							<div class="lowin-group">
								<label>Email</label>
								<input type="email" name="email" autocomplete="email" class="lowin-input" id="userEmail">
							</div>
							<div class="lowin-group">
								<label>密&nbsp;&nbsp;码</label>
								<input type="password" maxlength="16" name="password" class="lowin-input" id="userPassword">
							</div>
							<div class="lowin-group">
								<label>确认密码</label>
								<input type="password" maxlength="16" name="confirmPassword" class="lowin-input" id="confirmPassword">
							</div>
							<div class="lowin-group">
								<label>验证码</label>
								<input type="text" name="veriCode" class="lowin-input col-5" id="veriCode">
								<div class="col-3"></div>
								<a class="lowin-btn col-4" id="btnSendVeriCode" style="margin-top: 15px">
									发送验证码
								</a>
							</div>
							<button class="lowin-btn" style="margin-top: 15px" type="button" onclick="signup()">
								注册
							</button>

							<div class="text-foot">
								已有账户？ <a href="" class="login-link">现在登录</a>
							</div>
						</form>
					</div>
				</div>
			</div>

			<footer class="lowin-footer">
				<!--Design By @itskodinger. More Templates <a href="http://www.cssmoban.com/" target="_blank" title="模板之家">模板之家</a> - Collect from <a href="http://www.cssmoban.com/" title="网页模板" target="_blank">网页模板</a>-->
			</footer>
		</div>
	</div>

	<script src="/js/auth.js"></script>
	<script>
		Auth.init({
			login_url: '#login',
			forgot_url: '#forgot'
		});

        $().ready(function() {
// 在键盘按下并释放及提交后验证提交表单
            $("#signupForm").validate({
                rules: {
                    email: "required",
                    password: "required",
                    confirmPassword: "required",
                    veriCode: "required",
                    password: {
                        required: true,
                        minlength: 6,
                        maxlength: 16
                    },
                    confirmPassword: {
                        required: true,
                        minlength: 6,
                        maxlength: 16
                        // equalTo: "#password"
                    },
                    email: {
                        required: true,
                        email: true
                    },
					veriCode: {
                        required: true
					}

                },
                messages: {
                    email: "请输入Email",
                    password: "请输入密码",
                    password: {
                        required: "请输入密码",
                        minlength: "密码长度不能小于 6 位",
                        maxlength: "密码长度不能大于 16 位"
                    },
                    confirm_password: {
                        required: "请输入密码",
                        minlength: "密码长度不能小于 6 位",
                        maxlength: "密码长度不能大于 16 位",
                        equalTo: "两次密码输入不一致"
                    },
                    email: "请输入一个正确的邮箱"
                }
            })
        });

        $("#btnSendVeriCode").click(function () {
            send();
        })

        function send() {

            var email=$("#userEmail").val();
            // alert(email);
            $.ajax({
                type: "post",
                url: "/sendCode",
                data: {"email": email},
                // dataType: "json",
                success:function (data) {
                    alert(data);
                }
            });
        }

        function signin() {
            var email=$("#Email").val();
            var password=$("#Password").val();
            $.ajax({
                type: "post",
                url: "signinAction",
                data: {"email": email,
                "password":password},
                // dataType: "json",
                success:function (data) {
                    if(data){
                        window.location.href='index';
					}else{
                        alert("用户名或密码错误！");
					}
                }
            })
        }

        function signup() {
            var email = $("#userEmail").val();
            var password = $("#userPassword").val();
            var confirmPassword=$("#confirmPassword").val();
            var veriCode=$("#veriCode").val();
            $.ajax({
                type: "post",
                url: "signupAction",
                data: {
                    "email": email,
                    "password": password,
					"confirmPassword":confirmPassword,
					"veriCode":veriCode
                },
                // dataType: "json",
                success: function (data) {
                    if (data=="注册成功") {
                        alert(data);
                        window.location.href = 'index';
                    } else {
                        alert(data);
                    }
                }
            })
        }
	</script>

{{>layout/footer}}

</body>
</html>